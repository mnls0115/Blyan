<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How It Works - Blyan</title>
    <link rel="icon" href="/favicon.png" type="image/png">
    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <link rel="stylesheet" href="components.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="common-header-themed.css">
    <script src="language.js"></script>
    <script src="wallet.js"></script>
    <script src="theme.js?v=2"></script>
    <style>
        /* Theme-based styling using semantic tokens */
        :root {
            /* Light mode CSS variables (default) */
            --color-primary: #1E3A8A;
            --color-primary-light: #2E4EAE;
            --color-primary-dark: #152C66;
            --color-secondary: #06B6D4;
            --color-secondary-light: #22D3EE;
            --color-secondary-dark: #0891B2;
            --color-background: #FFFFFF;
            --color-surface: #F9FAFB;
            --color-elevated: #FFFFFF;
            --color-text-primary: #111827;
            --color-text-secondary: #374151;
            --color-text-disabled: #9CA3AF;
            --color-divider: #E5E7EB;
            --color-action-hover: rgba(30, 58, 138, 0.08);
            --color-action-selected: rgba(30, 58, 138, 0.12);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 16px 32px rgba(0, 0, 0, 0.12);
        }
        
        /* Dark mode CSS variables */
        [data-theme="dark"] {
            --color-primary: #22D3EE;
            --color-primary-light: #67E8F9;
            --color-primary-dark: #06B6D4;
            --color-secondary: #2E4EAE;
            --color-secondary-light: #4361C2;
            --color-secondary-dark: #1E3A8A;
            --color-background: #111827;
            --color-surface: #1F2937;
            --color-elevated: #0F172A;
            --color-text-primary: #F9FAFB;
            --color-text-secondary: #D1D5DB;
            --color-text-disabled: #4B5563;
            --color-divider: #374151;
            --color-action-hover: rgba(6, 182, 212, 0.12);
            --color-action-selected: rgba(6, 182, 212, 0.16);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.4);
            --shadow-xl: 0 16px 32px rgba(0, 0, 0, 0.5);
        }
        
        /* Base styles using semantic tokens */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--color-text-primary);
            background-color: var(--color-background);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, 
                var(--color-primary) 0%, 
                var(--color-secondary) 100%);
            color: var(--color-background);
            padding: 100px 20px 60px;
            text-align: center;
        }
        
        .hero-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 20px;
            letter-spacing: -0.02em;
            color: inherit;
        }
        
        .hero-subtitle {
            font-size: 1.25rem;
            font-weight: 300;
            opacity: 0.95;
            color: inherit;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Process Section */
        .process-section {
            padding: 80px 20px;
            background: var(--color-background);
        }
        
        .section-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .process-grid {
            display: grid;
            gap: 60px;
            margin-top: 60px;
        }
        
        .process-step {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 40px;
            align-items: center;
        }
        
        .process-step:nth-child(even) {
            grid-template-columns: 2fr 1fr;
        }
        
        .process-step:nth-child(even) .process-visual {
            order: 2;
        }
        
        .process-step:nth-child(even) .process-content {
            order: 1;
        }
        
        .process-visual {
            background: var(--color-surface);
            border-radius: 16px;
            padding: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 250px;
            border: 1px solid var(--color-divider);
        }
        
        .process-icon {
            font-size: 80px;
            opacity: 0.8;
        }
        
        .process-content {
            padding: 20px;
        }
        
        .process-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            color: var(--color-background);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 20px;
        }
        
        .process-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: 16px;
        }
        
        .process-description {
            font-size: 1.125rem;
            color: var(--color-text-secondary);
            line-height: 1.7;
            margin-bottom: 20px;
        }
        
        .process-details {
            background: var(--color-surface);
            border-left: 3px solid var(--color-primary);
            padding: 16px 20px;
            border-radius: 8px;
        }
        
        .process-details ul {
            list-style: none;
            padding: 0;
        }
        
        .process-details li {
            padding: 8px 0;
            display: flex;
            align-items: flex-start;
        }
        
        .process-details li::before {
            content: "→";
            color: var(--color-primary);
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        /* Technical Details Section */
        .technical-section {
            padding: 80px 20px;
            background: var(--color-surface);
        }
        
        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 32px;
            margin-top: 60px;
        }
        
        .tech-card {
            background: var(--color-background);
            border-radius: 16px;
            padding: 32px;
            border: 1px solid var(--color-divider);
            transition: all 0.3s ease;
        }
        
        .tech-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
            border-color: var(--color-primary);
        }
        
        .tech-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-bottom: 20px;
            color: var(--color-background);
        }
        
        .tech-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: 12px;
        }
        
        .tech-description {
            font-size: 1rem;
            color: var(--color-text-secondary);
            line-height: 1.7;
        }
        
        /* CTA Section */
        .cta-section {
            padding: 80px 20px;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: var(--color-background);
            text-align: center;
        }
        
        .cta-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .cta-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 24px;
            color: inherit;
        }
        
        .cta-text {
            font-size: 1.25rem;
            line-height: 1.8;
            margin-bottom: 40px;
            opacity: 0.95;
            color: inherit;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .cta-button {
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            display: inline-block;
        }
        
        .cta-primary {
            background: var(--color-background);
            color: var(--color-primary);
        }
        
        .cta-primary:hover {
            background: var(--color-surface);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .cta-secondary {
            background: transparent;
            color: var(--color-background);
            border: 2px solid var(--color-background);
        }
        
        .cta-secondary:hover {
            background: rgba(255,255,255,0.15);
            transform: translateY(-2px);
        }
        
        /* Theme toggle button */
        .theme-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--color-primary);
            color: var(--color-background);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .process-step {
                grid-template-columns: 1fr;
            }
            
            .process-step:nth-child(even) {
                grid-template-columns: 1fr;
            }
            
            .process-visual {
                min-height: 200px;
            }
            
            .tech-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-in {
            animation: fadeInUp 0.6s ease-out;
        }
    </style>
</head>
<body>
    <div id="header-container"></div>
    
    <!-- Hero Section -->
    <div class="hero-section animate-in">
        <div class="hero-container">
            <h1 class="hero-title">How Blyan Works</h1>
            <p class="hero-subtitle">From user query to AI response - powered by blockchain consensus</p>
        </div>
    </div>

    <!-- Process Section -->
    <div class="process-section">
        <div class="section-container">
            <div class="process-grid">
                <!-- Step 1: Input & Response Flow -->
                <div class="process-step animate-in">
                    <div class="process-visual">
                        <div class="process-icon">💬</div>
                    </div>
                    <div class="process-content">
                        <div class="process-number">1</div>
                        <h2 class="process-title">Input & Response Flow</h2>
                        <p class="process-description">
                            When you send a message, multiple GPU nodes collaborate to generate the response. Some experts run on Node 1 (handling language understanding), while others run on Node 2 (generating the response). The coordinator orchestrates this distributed computation - first checking for cached expert combinations, then routing requests to appropriate nodes. Each node loads only its assigned expert weights from the blockchain and streams tokens back in real-time.
                        </p>
                        <div class="process-details">
                            <ul>
                                <li>Request routing: Coordinator finds which nodes have required experts and balances load across the network</li>
                                <li>Distributed execution: Language experts on Node 1 process input, response experts on Node 2 generate output</li>
                                <li>Real-time streaming: Tokens flow back through the coordinator as they're generated, enabling immediate response</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Learning & Model Updates -->
                <div class="process-step animate-in">
                    <div class="process-visual">
                        <div class="process-icon">🧠</div>
                    </div>
                    <div class="process-content">
                        <div class="process-number">2</div>
                        <h2 class="process-title">Proof-of-Learning (PoL) & Model Updates</h2>
                        <p class="process-description">
                            Through our Proof-of-Learning (PoL) consensus mechanism, nodes validate model improvements by demonstrating measurable quality gains. When idle, nodes automatically engage in PoL training to improve their experts. Contributors evolve individual experts through expansion, mutation, or pruning operations. During high inference demand, PoL accelerates as the system accumulates rewards that can be distributed to contributing nodes. The evolution process tracks lineage through parent relationships and version compatibility, enabling the model to grow organically.
                        </p>
                        <div class="process-details">
                            <ul>
                                <li>Proof-of-Learning validation: Nodes must prove their training improved model quality to earn rewards</li>
                                <li>Idle time PoL training: Nodes train experts when not serving inference requests, maximizing GPU utilization</li>
                                <li>Demand-driven evolution: High inference activity generates more rewards, incentivizing rapid PoL improvements</li>
                                <li>Organic growth: New expert versions branch from existing ones, coexisting until PoL validates superiority</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Participation & Rewards -->
                <div class="process-step animate-in">
                    <div class="process-visual">
                        <div class="process-icon">💎</div>
                    </div>
                    <div class="process-content">
                        <div class="process-number">3</div>
                        <h2 class="process-title">Participation & Rewards</h2>
                        <p class="process-description">
                            Nodes join the network by registering their available experts and device profiles. When active, they serve inference requests - Node 1 might handle understanding tasks while Node 2 generates responses. During quiet periods, nodes switch to learning mode, improving their experts. As inference demand grows, accumulated rewards flow to contributing nodes based on their actual usage and quality metrics.
                        </p>
                        <div class="process-details">
                            <ul>
                                <li>Node registration: Join with specific experts and start receiving appropriate inference requests</li>
                                <li>Active serving: Process assigned expert computations when selected by the coordinator</li>
                                <li>Learning mode: Train and improve experts during idle time, preparing for future requests</li>
                                <li>Reward accumulation: High inference activity generates rewards distributed based on contribution</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Technical Details Section -->
    <div class="technical-section">
        <div class="section-container">
            <div class="section-header" style="text-align: center; margin-bottom: 60px;">
                <h2 style="font-size: 2.5rem; font-weight: 700; color: var(--color-text-primary); margin-bottom: 16px;">
                    Key Technologies
                </h2>
                <p style="font-size: 1.25rem; color: var(--color-text-secondary); max-width: 600px; margin: 0 auto;">
                    The building blocks that make decentralized AI possible
                </p>
            </div>
            <div class="tech-grid">
                <div class="tech-card animate-in">
                    <div class="tech-icon">⚡</div>
                    <h3 class="tech-title">TensorBlock Format</h3>
                    <p class="tech-description">
                        Efficient storage format with compact header and contiguous tensor data for instant loading. Supports multiple precision levels with quantization. Integrity verification without loading full tensors.
                    </p>
                </div>
                <div class="tech-card animate-in">
                    <div class="tech-icon">🔗</div>
                    <h3 class="tech-title">Dual-Chain Architecture</h3>
                    <p class="tech-description">
                        Chain A stores architecture specifications, Chain B stores expert weights. Dependency tracking enables parallel evolution branches that merge intelligently.
                    </p>
                </div>
                <div class="tech-card animate-in">
                    <div class="tech-icon">🛡️</div>
                    <h3 class="tech-title">Evolution Block System</h3>
                    <p class="tech-description">
                        Blocks track parent relationships, version numbers, evolution types, and dimensional changes. Compatible versions merge automatically while incompatible branches fork.
                    </p>
                </div>
                <div class="tech-card animate-in">
                    <div class="tech-icon">🎯</div>
                    <h3 class="tech-title">Expert Routing & Caching</h3>
                    <p class="tech-description">
                        Router calculates probability scores across all experts, selecting the best ones for each layer. Frequently used experts stay cached in memory with usage statistics tracked for rewards.
                    </p>
                </div>
                <div class="tech-card animate-in">
                    <div class="tech-icon">🔄</div>
                    <h3 class="tech-title">Distributed Inference Network</h3>
                    <p class="tech-description">
                        Nodes register their available experts through the network. The coordinator routes requests to appropriate nodes, monitoring availability and handling automatic failover.
                    </p>
                </div>
                <div class="tech-card animate-in">
                    <div class="tech-icon">📊</div>
                    <h3 class="tech-title">Reward Distribution System</h3>
                    <p class="tech-description">
                        The system tracks contributions and distributes rewards based on actual usage, quality metrics, and network demand. Maintains economic balance through controlled token distribution.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <div class="cta-section">
        <div class="cta-content animate-in">
            <h2 class="cta-title">Ready to Experience Decentralized AI?</h2>
            <p class="cta-text">
                Join thousands of contributors building the future of open AI
            </p>
            <div class="cta-buttons">
                <a href="chat.html" class="cta-button cta-primary">Try It Now</a>
                <a href="contribute.html" class="cta-button cta-secondary">Become a Contributor</a>
            </div>
        </div>
    </div>

    <script src="config.js?v=2"></script>
    <script src="api-auth.js?v=2"></script>
    <script src="common-header.js?v=2"></script>
    
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
        <span id="themeIcon">🌙</span>
    </button>
    
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // Initialize theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
            
            // Create header
            document.getElementById('header-container').innerHTML = createAIBlockHeader('how-it-works');

            // Theme toggle functionality
            document.getElementById('themeToggle').addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            });
            
            // Add scroll animations
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-in');
                    }
                });
            }, observerOptions);
            
            // Observe all animatable elements
            document.querySelectorAll('.process-step, .tech-card').forEach(el => {
                observer.observe(el);
            });
        });
        
        // Helper function to update theme icon
        function updateThemeIcon(theme) {
            const icon = document.getElementById('themeIcon');
            icon.textContent = theme === 'light' ? '🌙' : '☀️';
        }
    </script>
</body>
</html>